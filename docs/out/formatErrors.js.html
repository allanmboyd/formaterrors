<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: formaterrors   formatErrors.js  (YUI Library)</title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1326886468.06" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1326886468.06" />

    <script type="text/javascript" src="assets/api-js?stamp=1326886468.06"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1326886468.06"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	<div id="hd">
        <h1><a href="http://github.com/allanmboyd/formaterrors" title="formaterrors">formaterrors</a></h1>
        <h3>formaterrors&nbsp; <span class="subtitle">v0.0.3</span></h3>
        <a href="./index.html" title="formaterrors">formaterrors</a> 
            &gt; <a href="./module_formaterrors.html" title="formaterrors">formaterrors</a>
                
                 &gt; formatErrors.js (source view) 
	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * An API that provides various options for formatting and highlighting Errors. May be useful for logging and test</span>
<span class="cm"> * frameworks for example.</span>
<span class="cm"> *</span>
<span class="cm"> * Stack lines can be filtered in and out based on patterns and limited by range (e.g. lines 2 through 10). Stack lines</span>
<span class="cm"> * and error message can have highlights applied based on patterns. Finally stack lines can be formatted to include or</span>
<span class="cm"> * exclude available fields.</span>
<span class="cm"> *</span>
<span class="cm"> * The API is quite flexible with a range of methods varying in level with means to specify custom highlights and</span>
<span class="cm"> * formats.</span>
<span class="cm"> * @module formaterrors</span>
<span class="cm"> * @class formaterrors</span>
<span class="cm"> * @requires diffMatchPatch, stack-trace</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">util</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;util&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">diffMatchPatch</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;diff_match_patch&quot;</span><span class="p">)).</span><span class="nx">diff_match_patch</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">stackTrace</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;stack-trace&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">LONG_EXPECTED</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">LONG_ACTUAL</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DEFAULT_FORMAT</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StackFormat</span><span class="p">();</span>

<span class="cm">/**</span>
<span class="cm"> * Format the stack part (i.e. the stack lines not the message part in the stack) according to a specified StackFormat.</span>
<span class="cm"> * (See exports.StackFormat for available stack line fields.)</span>
<span class="cm"> *</span>
<span class="cm"> * @param {Error} error the error whose stack to format</span>
<span class="cm"> * @param {StackFormat} stackFormat the specification for the required format</span>
<span class="cm"> * @return {Error} the given error with its stack modified according to the given StackFormat</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">formatStack</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">stackFormat</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">formatStackInternal</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">getMessages</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;\n&quot;</span><span class="p">,</span> <span class="nx">stackFormat</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * @param {AssertionError} assertionError an AssertionError</span>
<span class="cm"> * @param {StackTheme} stackTheme the theme for the error</span>
<span class="cm"> * @return {Error} the given assertionError with stack hightlighted according to the StackTheme specification</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">highlightAssertionError</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">assertionError</span><span class="p">,</span> <span class="nx">stackTheme</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isActualExpectedError</span><span class="p">(</span><span class="nx">assertionError</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">assertionError</span><span class="p">.</span><span class="nx">expected</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="nx">LONG_EXPECTED</span> <span class="o">&amp;&amp;</span>
        <span class="nx">assertionError</span><span class="p">.</span><span class="nx">actual</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="nx">LONG_ACTUAL</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="nx">diffMatchPatch</span><span class="p">.</span><span class="nx">diff_main</span><span class="p">(</span><span class="nx">assertionError</span><span class="p">.</span><span class="nx">expected</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">assertionError</span><span class="p">.</span><span class="nx">actual</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
        <span class="nx">diffMatchPatch</span><span class="p">.</span><span class="nx">diff_cleanupSemantic</span><span class="p">(</span><span class="nx">diff</span><span class="p">);</span>
        <span class="nx">assertionError</span><span class="p">.</span><span class="nx">diff</span> <span class="o">=</span> <span class="nx">diff</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">diffToMessage</span><span class="p">(</span><span class="nx">assertionError</span><span class="p">);</span>
        <span class="nx">assertionError</span> <span class="o">=</span> <span class="nx">formatStackInternal</span><span class="p">(</span><span class="nx">assertionError</span><span class="p">,</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">DEFAULT_FORMAT</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">assertionError</span><span class="p">.</span><span class="nx">stack</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">applyStackTheme</span><span class="p">(</span><span class="nx">assertionError</span><span class="p">.</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">stackTheme</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">assertionError</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Convenience method that highlights the message line and all module related lines in bold.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack an Error stack (i.e. error.stack)</span>
<span class="cm"> * @param {String} moduleName the name of a module whose stack lines to highlight in bold</span>
<span class="cm"> * @return {String} a new error stack with bold message and module entries.</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">boldMessageBoldModuleStack</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">moduleName</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">format</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">StackTheme</span><span class="p">();</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">messageLineHighlights</span> <span class="o">=</span> <span class="p">[</span><span class="nx">exports</span><span class="p">.</span><span class="nx">STYLES</span><span class="p">.</span><span class="nx">BOLD</span><span class="p">];</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">stackHighlights</span> <span class="o">=</span> <span class="p">[</span><span class="nx">exports</span><span class="p">.</span><span class="nx">STYLES</span><span class="p">.</span><span class="nx">BOLD</span><span class="p">];</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">stackHighlightPatterns</span> <span class="o">=</span> <span class="p">[</span><span class="nx">moduleName</span><span class="p">];</span>
    <span class="k">return</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">applyStackTheme</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">format</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Convenience method to apply a given set of highlights to a an error stack.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack an Error stack (i.e. error.stack)</span>
<span class="cm"> * @param {String[]} messageLineHighlights an array of prefixes to be applied to the first line of the stack</span>
<span class="cm"> * (e.g. [exports.styles.RED, exports.styles.BOLD])</span>
<span class="cm"> * @param {String[]} stackHighlights an array of prefixes to be applied to each line (e.g. [exports.styles.RED,</span>
<span class="cm"> * exports.styles.BOLD]) matching one or more of the provided &quot;stackPatterns&quot;</span>
<span class="cm"> * @param {String[]} stackPatterns an array of regular expressions against which to perform match operations on each line of the stack</span>
<span class="cm"> * @param {Boolean} inclusive use the patterns to include or exclude from the stack. Defaults to true.</span>
<span class="cm"> * @return {String} a new error stack String highlighted as specified by the parameters</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">applyStackHighlights</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">messageLineHighlights</span><span class="p">,</span> <span class="nx">stackHighlights</span><span class="p">,</span> <span class="nx">stackPatterns</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">format</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">StackTheme</span><span class="p">();</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">messageLineHighlights</span> <span class="o">=</span> <span class="nx">messageLineHighlights</span><span class="p">;</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">stackHighlights</span> <span class="o">=</span> <span class="nx">stackHighlights</span><span class="p">;</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">stackHighlightPatterns</span> <span class="o">=</span> <span class="nx">stackPatterns</span><span class="p">;</span>
    <span class="nx">format</span><span class="p">.</span><span class="nx">highlightInclusive</span> <span class="o">=</span> <span class="nx">inclusive</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">applyStackTheme</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">format</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Convenience method to apply multiple transformations to an error stack.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack an error stack (i.e. error.stack)</span>
<span class="cm"> * @param {StackTheme} theme the theme for the stack</span>
<span class="cm"> * @return {String} a new error stack String transformed according to the specified StackFormat</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">applyStackTheme</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">theme</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">theme</span><span class="p">.</span><span class="nx">stackRange</span><span class="p">.</span><span class="nx">start</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">stackRange</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">stackRange</span><span class="p">.</span><span class="nx">start</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">stackRange</span><span class="p">.</span><span class="nx">depth</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">theme</span><span class="p">.</span><span class="nx">stackFilters</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">stackFilter</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">stackFilters</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">filterInclusive</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">theme</span><span class="p">.</span><span class="nx">stackHighlights</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">stackHighlight</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">stackHighlightPatterns</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">stackHighlights</span><span class="p">,</span>
            <span class="nx">theme</span><span class="p">.</span><span class="nx">highlightInclusive</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">theme</span><span class="p">.</span><span class="nx">messageLineHighlights</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">highlightStackMessage</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">messageLineHighlights</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">newStack</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Highlight just the first line of an error stack - i.e. the message part</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack an Error stack (i.e. error.stack)</span>
<span class="cm"> * @param {String[]} highlights an array of prefixes to be applied to each matching line (e.g. [exports.styles.RED,</span>
<span class="cm"> * exports.styles.BOLD])</span>
<span class="cm"> * @return {String} a new error stack with the given highlights applied to the message part</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">highlightStackMessage</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">highlights</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">highlights</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">stack</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">newStack</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">messagePrefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">highlights</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">messagePrefix</span> <span class="o">+=</span> <span class="nx">highlights</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">lines</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isMessageLine</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">line</span> <span class="o">=</span> <span class="nx">messagePrefix</span> <span class="o">+</span> <span class="nx">line</span> <span class="o">+</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">STYLES</span><span class="p">.</span><span class="nx">NORMAL</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">newStack</span> <span class="o">+=</span> <span class="nx">line</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newStack</span> <span class="o">+=</span> <span class="s1">&#39;\n&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">newStack</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Given an stack from an Error return a subset of the lines in the stack. The first line (aka the message) is always</span>
<span class="cm"> * included.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack the Error stack (i.e. error.stack)</span>
<span class="cm"> * @param {Number} start the first line of the stack to include in the range. Note that the message lines are always included</span>
<span class="cm"> * as the real first lines regardless of the value of &#39;start&#39;.</span>
<span class="cm"> * @param {Number} depthFromStart optional number of lines from &#39;start&#39; to include in the returned stack. If not provided the full</span>
<span class="cm"> * stack depth starting from &#39;start&#39; is provided.</span>
<span class="cm"> * @return {String} a new error stack containing the specified range of lines from the provided stack.</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">stackRange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">depthFromStart</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">origLines</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">newStack</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">isMessageLine</span><span class="p">(</span><span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">+=</span> <span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">end</span> <span class="o">=</span> <span class="nx">depthFromStart</span> <span class="o">?</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">depthFromStart</span> <span class="o">:</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+=</span> <span class="nx">start</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">end</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newStack</span> <span class="o">+=</span> <span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newStack</span> <span class="o">+=</span> <span class="s2">&quot;\n&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">newStack</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Filter lines of a stack in or out of the stack based on an array of regexp values. If a line matches a regexp then</span>
<span class="cm"> * it is either included or excluded in the returned stack based on the value of &#39;inclusive&#39;.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack a stack from an Error (i.e. error.stack)</span>
<span class="cm"> * @param {String[]} filters an array of regular expressions against which to perform match operations on each line of the</span>
<span class="cm"> * stack</span>
<span class="cm"> * @param {Boolean} inclusive use the filters to include or exclude from the stack. Defaults to true.</span>
<span class="cm"> * @return {String} a new error stack filtered according to the &#39;filters&#39; and &#39;inclusive&#39; values</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">stackFilter</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">filters</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">includedAction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">includedLine</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">newStack</span> <span class="o">+</span> <span class="nx">includedLine</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">excludedAction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newStack</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">newStack</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">applyFilters</span><span class="p">(</span><span class="nx">includedAction</span><span class="p">,</span> <span class="nx">excludedAction</span><span class="p">,</span> <span class="nx">stack</span><span class="p">,</span> <span class="nx">filters</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Apply highlights to an error stack including the message part (line 0 of error.stack) based on matching patterns.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} stack a stack from an Error (i.e. error.stack)</span>
<span class="cm"> * @param {String[]} patterns an array of regular expressions against which to perform match operations on each line of the stack</span>
<span class="cm"> * @param highlights an array of prefixes to be applied to each matching line (e.g. [exports.styles.RED,</span>
<span class="cm"> * exports.styles.BOLD])</span>
<span class="cm"> * @param {Boolean} inclusive use the patterns to include or exclude from the stack. Defaults to true.</span>
<span class="cm"> * @return {String} a new error stack highlighted with the specified highlights according to the provided patterns</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">stackHighlight</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="nx">patterns</span><span class="p">,</span> <span class="nx">highlights</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">highlights</span> <span class="o">||</span> <span class="nx">highlights</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">stack</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">includedAction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">includedLine</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">newLine</span> <span class="o">=</span> <span class="nx">highlights</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">highlights</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newLine</span> <span class="o">+=</span> <span class="nx">highlights</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="nx">newLine</span> <span class="o">+=</span> <span class="nx">includedLine</span> <span class="o">+</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">STYLES</span><span class="p">.</span><span class="nx">NORMAL</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">newStack</span> <span class="o">+</span> <span class="nx">newLine</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">excludedAction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">excludedLine</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">newStack</span> <span class="o">+</span> <span class="nx">excludedLine</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">applyFilters</span><span class="p">(</span><span class="nx">includedAction</span><span class="p">,</span> <span class="nx">excludedAction</span><span class="p">,</span> <span class="nx">stack</span><span class="p">,</span> <span class="nx">patterns</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Apply filters to the lines of an error.stack and call the includedAction or the excludedAction functions based on</span>
<span class="cm"> * the result of the match and the value of the &#39;inclusive&#39; parameter. If based on the filter a stack line is included</span>
<span class="cm"> * includedAction is invoked with the current value of the stack under construction and the current stack line. Otherwise</span>
<span class="cm"> * excludedAction is called with the same arguments.</span>
<span class="cm"> *</span>
<span class="cm"> * This function is common to higher level functions that operate based on stack line filtering and should only be</span>
<span class="cm"> * required to meet bespoke behaviour that cannot be achieved through the higher level functions (e.g.</span>
<span class="cm"> * exports.stackHighlight and exports.stackFilter).</span>
<span class="cm"> *</span>
<span class="cm"> * Normally there should be no need to call this function directly.</span>
<span class="cm"> * </span>
<span class="cm"> * @param {Function(stack, stackLine)} includedAction the function to call for stack lines that are included based on filters and inclusive parameters.</span>
<span class="cm"> * Function signature is: includedAction(stackUnderConstruction, includedStackLine) returning the updated</span>
<span class="cm"> * stackUnderConstruction.</span>
<span class="cm"> * @param {Function(stack, stackLine)} excludedAction the function to call for stack lines that are excluded based on filters and inclusive parameters.</span>
<span class="cm"> * Function signature is: excludedAction(stackUnderConstruction, excludedStackLine) returning the updated</span>
<span class="cm"> * stackUnderConstruction.</span>
<span class="cm"> * @param {String} stack a stack from an Error (i.e. error.stack)</span>
<span class="cm"> * @param {String[]} filters an array of regular expressions against which to perform match operations on each line of the</span>
<span class="cm"> * stack</span>
<span class="cm"> * @param {Boolean} inclusive use the filters to include or exclude from the stack. Defaults to true.</span>
<span class="cm"> * @param {Boolean} includeMessage include the message part of the stack in the filtering operation</span>
<span class="cm"> * @return {String} a new error stack modified according to the results of calls to includedAction and excludedAction based on</span>
<span class="cm"> * filters provided and the inclusive parameter.</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">applyFilters</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">includedAction</span><span class="p">,</span> <span class="nx">excludedAction</span><span class="p">,</span> <span class="nx">stack</span><span class="p">,</span> <span class="nx">filters</span><span class="p">,</span> <span class="nx">inclusive</span><span class="p">,</span> <span class="nx">includeMessage</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">origLines</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">newStack</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inclusive</span> <span class="o">!==</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="nx">inclusive</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inclusive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">includeMessage</span> <span class="o">&amp;&amp;</span> <span class="nx">isMessageLine</span><span class="p">(</span><span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">newStack</span> <span class="o">+=</span> <span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">filterMatch</span><span class="p">(</span><span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">filters</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">((</span><span class="nx">inclusive</span> <span class="o">&amp;&amp;</span> <span class="nx">filter</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">inclusive</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">filter</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">includedAction</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">newStack</span> <span class="o">=</span> <span class="nx">excludedAction</span><span class="p">(</span><span class="nx">newStack</span><span class="p">,</span> <span class="nx">origLines</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">origLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">newStack</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">newStack</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newStack</span> <span class="o">+=</span> <span class="s2">&quot;\n&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">newStack</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Determine if a provided array of regular expressions includes a match for a provided String.</span>
<span class="cm"> *</span>
<span class="cm"> * @method filterMatch</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {String} s the String</span>
<span class="cm"> * @param {String[]} regExps an array of reg. exp. Strings</span>
<span class="cm"> * @return {Boolean} true if a match is found; false otherwise</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">filterMatch</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">regExps</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">regExps</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">regExps</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">match</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">match</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regExps</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">match</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Enhance an Error by adding a stackLines property that contains only the stack lines of the provided error</span>
<span class="cm"> * (i.e. no message lines). The stackLines property is an array of V8 CallStack objects.</span>
<span class="cm"> *</span>
<span class="cm"> * (Would have preferred to clone the given error but it seems that Object.keys(error) is always empty - so that</span>
<span class="cm"> * does not work.)</span>
<span class="cm"> *</span>
<span class="cm"> * @method enhanceError</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {Error} error an Error</span>
<span class="cm"> * @return {Error} the given error with an added stackLines property as an array of V8 CallStack objects</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">enhanceError</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isError</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s2">&quot;Expected &#39;error&#39; to be an Error&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">error</span><span class="p">.</span><span class="nx">stackLines</span> <span class="o">=</span> <span class="nx">stackTrace</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">error</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Determine if a given line is a line from the stack part of a stack trace (as opposed to the message part)</span>
<span class="cm"> *</span>
<span class="cm"> * @method isStackLine</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {String} line the line String</span>
<span class="cm"> * @return {Boolean} true if the given line is deemed to be a stack line; false otherwise</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">isStackLine</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">line</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/at (?:([^\s]+)\s+)?\(?(?:(.+?):(\d+):(\d+)|([^)]+))\)?/</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Determine if a given line is a line from the message part of a stack trace (as opposed to the stack part).</span>
<span class="cm"> *</span>
<span class="cm"> * @method isMessageLine</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {String} line the line String</span>
<span class="cm"> * @param {Number} lineNumber the line number of the given line within the stack from which it originated</span>
<span class="cm"> * @return {Boolean} true is the given line is deemed to be a stack line; false otherwise</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">isMessageLine</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">lineNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">lineNumber</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nx">isStackLine</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Determine if a given Error has actual and expected fields.</span>
<span class="cm"> *</span>
<span class="cm"> * @method isActualExpectedError</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {Error} error the Error</span>
<span class="cm"> * @return {Boolean} true if the given Error contains values for both actual and expected</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">isActualExpectedError</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">error</span><span class="p">.</span><span class="nx">expected</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">actual</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Determine if a given parameter is an Error.</span>
<span class="cm"> *</span>
<span class="cm"> * @method isError</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {Error} error the prospective Error</span>
<span class="cm"> * @return {Boolean} true is &#39;error&#39; is an Error; false otherwise</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">isError</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;Error&quot;</span> <span class="o">||</span>
        <span class="p">(</span><span class="k">typeof</span> <span class="nx">error</span><span class="p">.</span><span class="nx">stack</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">error</span><span class="p">.</span><span class="nx">name</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Get the messages part of an error.stack and return these as an array. (The returned array will only contain</span>
<span class="cm"> * multiple items if the message part consists of multiple lines.)</span>
<span class="cm"> *</span>
<span class="cm"> * @method getMessages</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {Error} error the error whose stack messages to provide</span>
<span class="cm"> * @return {String[]} the messages from the given error stack as an array</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">getMessages</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stackLines</span> <span class="o">=</span> <span class="nx">error</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">messageComplete</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">messageLines</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">stackLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">messageComplete</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isMessageLine</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">messageLines</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">messageComplete</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">messageLines</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Format the stack part (i.e. the stack lines not the message part in the stack) according to a specified StackFormat.</span>
<span class="cm"> * (See exports.StackFormat for available stack line fields.)</span>
<span class="cm"> *</span>
<span class="cm"> * @method formatStackInternal</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {Error} error the error whose stack to format</span>
<span class="cm"> * @param {String} message the message to include within the formatted stack</span>
<span class="cm"> * @param {StackFormat} stackFormat the StackFormat specification</span>
<span class="cm"> * @return {Error} the given error with its stack modified according to the given StackFormat</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">formatStackInternal</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">stackFormat</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">format</span> <span class="o">=</span> <span class="nx">stackFormat</span> <span class="o">||</span> <span class="nx">DEFAULT_FORMAT</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">enhanced</span> <span class="o">=</span> <span class="nx">enhanceError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="nx">message</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">enhanced</span><span class="p">.</span><span class="nx">stackLines</span> <span class="o">&amp;&amp;</span> <span class="nx">i1</span> <span class="o">&lt;</span> <span class="nx">enhanced</span><span class="p">.</span><span class="nx">stackLines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i1</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">stackLines</span> <span class="o">=</span> <span class="nx">enhanced</span><span class="p">.</span><span class="nx">stackLines</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">prefix</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">typeName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">fileName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">functionName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">methodName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">lineNumber</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">wrapFileDetails</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i2</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">components</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i2</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">i2</span><span class="p">];</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">component</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s2">&quot;typeName&quot;</span><span class="o">:</span>
                    <span class="nx">typeName</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getTypeName</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">typeName</span> <span class="o">&amp;&amp;</span> <span class="nx">typeName</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">typeName</span><span class="p">;</span>
                        <span class="nx">wrapFileDetails</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;functionName&quot;</span><span class="o">:</span>
                    <span class="nx">functionName</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getFunctionName</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">functionName</span> <span class="o">&amp;&amp;</span> <span class="nx">functionName</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">functionName</span> <span class="o">=</span> <span class="nx">functionName</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">typeName</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">typeName</span> <span class="o">&amp;&amp;</span> <span class="nx">typeName</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">functionName</span><span class="p">;</span>
                        <span class="nx">wrapFileDetails</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;methodName&quot;</span><span class="o">:</span>
                    <span class="nx">methodName</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getMethodName</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">methodName</span> <span class="o">&amp;&amp;</span> <span class="nx">methodName</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">methodName</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">functionName</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">typeName</span> <span class="o">&amp;&amp;</span> <span class="nx">typeNmae</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">methodName</span><span class="p">;</span>
                        <span class="nx">wrapFileDetails</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;fileName&quot;</span><span class="o">:</span>
                    <span class="nx">fileName</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getFileName</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">typeName</span> <span class="o">||</span> <span class="nx">functionName</span> <span class="o">||</span> <span class="nx">methodName</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">fileName</span> <span class="o">&amp;&amp;</span> <span class="nx">fileName</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">wrapFileDetails</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">fileName</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;lineNumber&quot;</span><span class="o">:</span>
                    <span class="nx">lineNumber</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getLineNumber</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">lineNumber</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">fileName</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">lineNumber</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;columnNumber&quot;</span><span class="o">:</span>
                    <span class="kd">var</span> <span class="nx">columnNumber</span> <span class="o">=</span> <span class="nx">stackLines</span><span class="p">[</span><span class="nx">i1</span><span class="p">].</span><span class="nx">getColumnNumber</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">columnNumber</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">fileName</span> <span class="o">||</span> <span class="nx">lineNumber</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">line</span> <span class="o">+=</span> <span class="nx">columnNumber</span><span class="p">;</span>
                    <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">fileName</span> <span class="o">&amp;&amp;</span> <span class="nx">wrapFileDetails</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">i1</span> <span class="o">&lt;</span> <span class="nx">stackLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">line</span> <span class="o">+=</span> <span class="s2">&quot;\n&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">stack</span> <span class="o">+=</span> <span class="nx">line</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">enhanced</span><span class="p">.</span><span class="nx">stack</span> <span class="o">=</span> <span class="nx">stack</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">enhanced</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Given an AssertionError that has had diffs applied - and that means it has a diff property - provide the message</span>
<span class="cm"> * for the AssertionError including details of the diffs.</span>
<span class="cm"> *</span>
<span class="cm"> * @method diffToMessage</span>
<span class="cm"> * @private</span>
<span class="cm"> * @param {AssertionError} diffedAssertionError an AssertionError that has a diff property containing diffs between the expected and</span>
<span class="cm"> * actual values</span>
<span class="cm"> * @return {String} the message that includes diff details</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">diffToMessage</span><span class="p">(</span><span class="nx">diffedAssertionError</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="nx">diffedAssertionError</span><span class="p">.</span><span class="nx">diff</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">diff</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">diffType</span> <span class="o">=</span> <span class="nx">diff</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">diffType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">actual</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">actual</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">actual</span> <span class="o">+=</span> <span class="s2">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="nx">diff</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">diffType</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">expected</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">expected</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">expected</span> <span class="o">+=</span> <span class="s2">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="nx">diff</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">&quot;Differences: &quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">expected</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">message</span> <span class="o">+=</span> <span class="s2">&quot;&#39;expected&#39;: &quot;</span> <span class="o">+</span> <span class="nx">expected</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">actual</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">expected</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">message</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">message</span> <span class="o">+=</span> <span class="s2">&quot;&#39;actual&#39;: &quot;</span> <span class="o">+</span> <span class="nx">actual</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">message</span> <span class="o">+=</span> <span class="s2">&quot;\n&quot;</span><span class="p">;</span>
    <span class="k">return</span>  <span class="nx">getMessages</span><span class="p">(</span><span class="nx">diffedAssertionError</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;\n&quot;</span> <span class="o">+</span> <span class="nx">message</span><span class="p">;</span>

<span class="p">}</span>


<span class="cm">/**</span>
<span class="cm"> * An object that describes the format of a stack line.</span>
<span class="cm"> * @class StackFormat</span>
<span class="cm"> * @for formaterrors</span>
<span class="cm"> * @constructor</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">StackFormat</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">prefix</span> <span class="o">=</span> <span class="s2">&quot;    at&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">components</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;typeName&quot;</span><span class="p">,</span> <span class="s2">&quot;functionName&quot;</span><span class="p">,</span> <span class="s2">&quot;methodName&quot;</span><span class="p">,</span> <span class="s2">&quot;fileName&quot;</span><span class="p">,</span> <span class="s2">&quot;lineNumber&quot;</span><span class="p">,</span> <span class="s2">&quot;columnNumber&quot;</span><span class="p">];</span>
<span class="p">}</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">StackFormat</span> <span class="o">=</span> <span class="nx">StackFormat</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * An object that may be used to define a theme for a a set operations (transformations) to apply to an error stack.</span>
<span class="cm"> * @class StackTheme</span>
<span class="cm"> * @for formaterrors</span>
<span class="cm"> * @constructor</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">StackTheme</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">messageLineHighlights</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackHighlights</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackHighlightPatterns</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">highlightInclusive</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackFilters</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterInclusive</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stackRange</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
        <span class="nx">depth</span><span class="o">:</span> <span class="kc">undefined</span>
    <span class="p">};</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Some provided styles for stackHighlight. These may be overridden or alternatives may be used as required.</span>
<span class="cm"> * @class STYLES</span>
<span class="cm"> * @static</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">STYLES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;RED&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[31m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GREEN&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[32m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;YELLOW&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[33m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BLUE&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[34m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PURPLE&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[35m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CYAN&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[36m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BOLD&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[1m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NORMAL&quot;</span><span class="o">:</span> <span class="s2">&quot;\u001B[39m\u001B[22m&quot;</span>
<span class="p">};</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class="selected"><a href="module_formaterrors.html" title="formaterrors">formaterrors</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="formaterrors.html" title="formaterrors">formaterrors</a></li>
                                <li class=""><a href="StackFormat.html" title="StackFormat">StackFormat</a></li>
                                <li class=""><a href="StackTheme.html" title="StackTheme">StackTheme</a></li>
                                <li class=""><a href="STYLES.html" title="STYLES">STYLES</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class="selected"><a href="formatErrors.js.html" title="formatErrors.js">formatErrors.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2012 Allan Michael Boyd.
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "formaterrors.html#method_applyFilters", "access": "", "host": "formaterrors", "type": "method", "name": "applyFilters"}, {"url": "formaterrors.html#method_applyStackHighlights", "access": "", "host": "formaterrors", "type": "method", "name": "applyStackHighlights"}, {"url": "formaterrors.html#method_applyStackTheme", "access": "", "host": "formaterrors", "type": "method", "name": "applyStackTheme"}, {"url": "formaterrors.html#method_boldMessageBoldModuleStack", "access": "", "host": "formaterrors", "type": "method", "name": "boldMessageBoldModuleStack"}, {"url": "formaterrors.html#method_formatStack", "access": "", "host": "formaterrors", "type": "method", "name": "formatStack"}, {"url": "formaterrors.html#method_highlightAssertionError", "access": "", "host": "formaterrors", "type": "method", "name": "highlightAssertionError"}, {"url": "formaterrors.html#method_highlightStackMessage", "access": "", "host": "formaterrors", "type": "method", "name": "highlightStackMessage"}, {"url": "formaterrors.html#method_stackFilter", "access": "", "host": "formaterrors", "type": "method", "name": "stackFilter"}, {"url": "formaterrors.html#method_stackHighlight", "access": "", "host": "formaterrors", "type": "method", "name": "stackHighlight"}, {"url": "formaterrors.html#method_stackRange", "access": "", "host": "formaterrors", "type": "method", "name": "stackRange"}];
</script>
</body>
</html>
